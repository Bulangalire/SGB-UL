{% extends 'base.html.twig' %}
{% block body %}

    <table>
        <tbody>
            <tr>
                <td valign="top">
                    {{form_start(frmDecaisser)}}
                    {{form_row(frmDecaisser.lignebudgetdepense)}}
                    {{form_row(frmDecaisser.lignebudgetsource)}}
                    {{form_row(frmDecaisser.montantdetail)}}
                    {{form_row(frmDecaisser.modepayement)}}
                    {{form_row(frmDecaisser.descriptiondetaildepense)}}
                    <br>
                    <button type="submit" class="btn btn-success">
                    {% if editMode %}
                    Modifier
                    {% else %}
                    Enregistrer
                    {% endif %}
                    </button>
                    {{form_end(frmDecaisser)}}

                </td>
                <td valign="top">
                    <h5>Les sorties pour cet OP
                    </h5>
                    <table class="table table-hover">
                        <thead>
                            <tr class="table-primary">
                                <th scope="col">ID</th>
                                <th scope="col">recette</th>
                                <th scope="col">date</th>
                                <th scope="col">montant</th>
                                 <th scope="col">Modifier</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% set numDepense = 0 %}
                            {% set totalDetail = 0 %}
                            {% for uneSortie in queryListDetailSortie %}
                                <tr>
                                    <th scope="row">
                                        {% set numDepense = numDepense + 1 %}
                                        {{ numDepense }}
                                    </th>
                                    <td>{{uneSortie.lesdetails.lignebudgetsource.lignebudgetprevision.intituleLigne}}
                                    </td>
                                    <td>{{uneSortie.lesdetails.createAt|date('d/m/Y') }}
                                    </td>
                                    {% set totalDetail = totalDetail + uneSortie.lesdetails.montantdetail %}
                                    <td>{{uneSortie.lesdetails.montantdetail}}
                                    </td>
                                     <td>
                                        <a href="{{path('edit_decaisser', {'id':uneSortie.lesdetails.id})}}">
                                            <img src="{{path('edit_button')}}"/></a>
                                            <a href="{{path('delete_caisser', {'id':uneSortie.lesdetails.id})}}">
                                            <img src="{{path('delete_button')}}"/></a>
                                    </td>

                                </tr>
                            {% endfor %}
                            <tr class="table-primary">
                                <th scope="row"></th>
                                <td></td>
                                <td></td>
                                <td>
                                    {{totalDetail}}
                                </td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </td>
                <td valign="top">

                    <h5>La situation de la caisse
                    </h5>
                    <table class="table table-hover">
                        <thead>
                            <tr class="table-primary">
                                <th scope="col">ID</th>
                                <th scope="col">Ligne recette</th>
                                <th scope="col">Service</th>
                                <th scope="col">Solde</th>

                            </tr>
                        </thead>
                        <tbody>
                           {% set numDepense = 0 %}
                            {% set totalSolde = 0 %}
                            {% for soldeParLigne in tblCaisse %}

                                <tr>
                                    <th scope="row">
                                        {% set numDepense = numDepense + 1 %}
                                        {{ numDepense }}
                                    </th>
                                    <td>
                                        {{soldeParLigne.maCaisse.lignebudgetprevision.intituleLigne}}</td>
                                    <td>
                                        {{soldeParLigne.maCaisse.service.designation}}</td>

                                    <td>
                                    {% set totalSolde = totalSolde + soldeParLigne.maCaisse.leSolde  %}
                                    {{soldeParLigne.maCaisse.leSolde}}</td>

                                

                                </tr>
                            {% endfor %}
                            <tr class="table-primary">
                                <th scope="row"></th>
                                <td></td>
                                <td></td>
                                <td>
                                    {{totalSolde}}
                                </td>
                            </tr>
                        </tbody>
                    </table>

                </td>
            </tr>
            <tr>
                <td></td>
                <td>

                    <td></td>
                </td>
            </tr>

        </tbody>
    </table>

{% endblock %}